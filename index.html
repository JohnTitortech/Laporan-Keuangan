<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Laporan Keuangan</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- ====================== STYLE SECTION ====================== -->
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }

    body {
      background-color: #f9fafc;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
    }

    .container {
      max-width: 500px;
      width: 100%;
      text-align: center;
    }

    h1 {
      font-size: 2rem;
      color: #1e293b;
      margin-bottom: 0.5rem;
    }

    p.subtitle {
      color: #475569;
      margin-bottom: 2rem;
    }

    /* Tombol navigasi atas */
    .button-group {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 2rem;
    }

    .btn {
      padding: 10px 20px;
      border-radius: 8px;
      border: 1px solid #d1d5db;
      background-color: white;
      font-weight: 500;
      cursor: pointer;
      transition: 0.2s;
    }

    .btn:hover {
      background-color: #f1f5f9;
    }

    .btn-primary {
      background-color: #2563eb;
      color: white;
      border: none;
    }

    /* Kartu/form */
    .card {
      background-color: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      text-align: left;
    }

    .card h2 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: #1e293b;
    }

    label {
      display: block;
      margin-bottom: 4px;
      color: #334155;
      font-weight: 500;
    }

    input, select {
      width: 100%;
      padding: 10px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      margin-bottom: 1rem;
      font-size: 0.95rem;
    }

    .row {
      display: flex;
      gap: 10px;
    }

    .row > div {
      flex: 1;
    }

    /* Tombol aksi bawah */
    .action-buttons {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .action-buttons .btn {
      flex: 1;
    }

    .btn-primary:hover {
      background-color: #1d4ed8;
    }

    .hidden {
      display: none;
    }
  </style>
  <!-- ====================== END STYLE SECTION ====================== -->
</head>
<body>

  <!-- ====================== MAIN CONTAINER ====================== -->
  <div class="container">
    <h1>Laporan Keuangan</h1>
    <p class="subtitle">Kelola dan pantau keuanganmu dengan mudah</p>

    <!-- ======== MENU NAVIGATION ======== -->
    <div class="button-group">
      <button id="btnKeuangan" class="btn btn-primary">Input Data Keuangan</button>
      <button id="btnEmoney" class="btn">E-money & E-wallet</button>
    </div>

    <!-- ============================================================= -->
    <!-- =============== FORM INPUT DATA KEUANGAN ==================== -->
    <!-- ============================================================= -->
    <div id="formKeuangan" class="card">
      <h2>Input Data Keuangan</h2>

      <label for="tglKeuangan">Tanggal</label>
      <input type="date" id="tglKeuangan">

      <div class="row">
        <div>
          <label for="keperluanKeuangan">Keperluan</label>
          <input type="text" id="keperluanKeuangan" placeholder="Masukkan keperluan">
        </div>
        <div>
          <label for="jenisKeuangan">Jenis</label>
          <select id="jenisKeuangan">
            <option>Pilih...</option>
            <option>Mandiri</option>
            <option>CIMB</option>
            <option>Jenius</option>
            <option>Dompet</option>
            <option>Rumah</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="tipeKeuangan">Tipe</label>
          <select id="tipeKeuangan">
            <option>Pilih...</option>
            <option>+</option>
            <option>-</option>
          </select>
        </div>
        <div>
          <label for="kategoriKeuangan">Kategori</label>
          <select id="kategoriKeuangan">
            <option>Pilih...</option>
          </select>
        </div>
      </div>

      <label for="jumlahKeuangan">Jumlah</label>
      <input type="number" id="jumlahKeuangan" placeholder="Masukkan nominal">

      <div class="action-buttons">
        <button class="btn btn-primary">Simpan Data</button>
        <button class="btn">Tampilkan Grafik</button>
        <button class="btn">Kembali</button>
      </div>
    </div>

    <!-- ============================================================= -->
    <!-- =============== FORM INPUT E-MONEY & E-WALLET =============== -->
    <!-- ============================================================= -->
    <div id="formEmoney" class="card hidden">
      <h2>Input Data E-money & E-wallet</h2>

      <label for="tglEmoney">Tanggal</label>
      <input type="date" id="tglEmoney">

      <div class="row">
        <div>
          <label for="keperluanEmoney">Keperluan</label>
          <input type="text" id="keperluanEmoney" placeholder="Masukkan keperluan">
        </div>
        <div>
          <label for="jenisEmoney">Jenis</label>
          <select id="jenisEmoney">
            <option>Pilih...</option>
            <option>KRL</option>
            <option>E-money</option>
            <option>Dana</option>
            <option>Ovo</option>
            <option>Gopay</option>
            <option>Shopeepay</option>
            <option>Seabank</option>
            <option></option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="tipeEmoney">Tipe</label>
          <select id="tipeEmoney">
            <option>Pilih...</option>
            <option>+</option>
            <option>-</option>
          </select>
        </div>
        <div>
          <label for="kategoriEmoney">Kategori</label>
          <select id="kategoriEmoney">
            <option>Pilih...</option>
          </select>
        </div>
      </div>

      <label for="jumlahEmoney">Jumlah</label>
      <input type="number" id="jumlahEmoney" placeholder="Masukkan nominal">

      <div class="action-buttons">
        <button class="btn btn-primary">Simpan Data</button>
        <button class="btn">Tampilkan Grafik</button>
        <button class="btn">Kembali</button>
      </div>
    </div>
  </div>

  <!-- ====================== SCRIPT SECTION ====================== -->
  <!-- ====================== SCRIPT SECTION ====================== -->
<script>
  /* ------------------------------------------------------------
     BAGIAN 1 — DEKLARASI ELEMEN NAVIGASI
  ------------------------------------------------------------ */
  const btnKeuangan = document.getElementById('btnKeuangan');
  const btnEmoney   = document.getElementById('btnEmoney');
  const formKeuangan = document.getElementById('formKeuangan');
  const formEmoney   = document.getElementById('formEmoney');

  /* ------------------------------------------------------------
     BAGIAN 2 — LOGIKA TOMBOL BERPINDAH FORM
  ------------------------------------------------------------ */
  btnKeuangan.addEventListener('click', () => {
    btnKeuangan.classList.add('btn-primary');
    btnEmoney.classList.remove('btn-primary');
    formKeuangan.classList.remove('hidden');
    formEmoney.classList.add('hidden');
  });

  btnEmoney.addEventListener('click', () => {
    btnEmoney.classList.add('btn-primary');
    btnKeuangan.classList.remove('btn-primary');
    formEmoney.classList.remove('hidden');
    formKeuangan.classList.add('hidden');
  });

  /* ------------------------------------------------------------
     BAGIAN 3 — LOGIKA OTOMATISASI KATEGORI (KEUANGAN)
  ------------------------------------------------------------ */
  const tipeKeuangan = document.getElementById('tipeKeuangan');
  const kategoriKeuangan = document.getElementById('kategoriKeuangan');

  tipeKeuangan.addEventListener('change', () => {
    kategoriKeuangan.innerHTML = '<option>Pilih...</option>';
    if (tipeKeuangan.value === '+') {
      ['Gaji', 'Ortu', 'Lutfi', 'Tarik Tunai', 'Transfer'].forEach(opt => {
        const o = document.createElement('option');
        o.textContent = opt;
        kategoriKeuangan.appendChild(o);
      });
    } else if (tipeKeuangan.value === '-') {
      ['Kebutuhan', 'Keinginan'].forEach(opt => {
        const o = document.createElement('option');
        o.textContent = opt;
        kategoriKeuangan.appendChild(o);
      });
    }
  });

  /* ------------------------------------------------------------
     BAGIAN 4 — LOGIKA OTOMATISASI KATEGORI (E-MONEY)
  ------------------------------------------------------------ */
  const tipeEmoney = document.getElementById('tipeEmoney');
  const kategoriEmoney = document.getElementById('kategoriEmoney');

  tipeEmoney.addEventListener('change', () => {
    kategoriEmoney.innerHTML = '<option>Pilih...</option>';
    if (tipeEmoney.value === '+') {
      ['Transfer'].forEach(opt => {
        const o = document.createElement('option');
        o.textContent = opt;
        kategoriEmoney.appendChild(o);
      });
    } else if (tipeEmoney.value === '-') {
      ['Kebutuhan', 'Keinginan'].forEach(opt => {
        const o = document.createElement('option');
        o.textContent = opt;
        kategoriEmoney.appendChild(o);
      });
    }
  });

  /* ------------------------------------------------------------
     BAGIAN 5 — KONFIGURASI URL SPREADSHEET
  ------------------------------------------------------------ */
  const scriptURL = "https://script.google.com/macros/s/AKfycbxHZqa0ulz1HqYZo__EHdhDweEKoWnqoL7rnZrMAdfXFYAYyQPJsr9H5wkmKTvHzNVc/exec"; // <-- GANTI DENGAN MILIKMU

  /* ------------------------------------------------------------
   BAGIAN 6 — LOGIKA KIRIM DATA KE SPREADSHEET (KEUANGAN)
------------------------------------------------------------ */
const btnSimpanKeuangan = formKeuangan.querySelector('.btn-primary');
const statusKeuangan = document.createElement('div');
statusKeuangan.style.textAlign = "center";
statusKeuangan.style.marginTop = "10px";
statusKeuangan.style.fontWeight = "600";
statusKeuangan.style.color = "#475569";
formKeuangan.appendChild(statusKeuangan);

btnSimpanKeuangan.addEventListener("click", async () => {
  const payload = {
    Source: "Keuangan",
    Tanggal: document.getElementById("tglKeuangan").value,
    Keperluan: document.getElementById("keperluanKeuangan").value.trim(),
    Jenis: document.getElementById("jenisKeuangan").value,
    Tipe: document.getElementById("tipeKeuangan").value,
    Kategori: document.getElementById("kategoriKeuangan").value,
    Jumlah: document.getElementById("jumlahKeuangan").value
  };

  if (!payload.Tanggal || !payload.Keperluan || !payload.Jumlah || payload.Tipe === "Pilih...") {
    alert("⚠️ Mohon lengkapi semua data sebelum mengirim!");
    return;
  }

  statusKeuangan.textContent = "⏳ Mengirim data...";
  btnSimpanKeuangan.disabled = true;

  try {
    const res = await fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify(payload)
    });

    if (res.ok) {
      statusKeuangan.textContent = "✅ Data berhasil dikirim ke Keuangan_2025!";
      statusKeuangan.style.color = "#16a34a";
      formKeuangan.querySelectorAll("input, select").forEach(el => el.value = "");
    } else throw new Error();
  } catch {
    statusKeuangan.textContent = "❌ Gagal mengirim data ke Keuangan_2025.";
    statusKeuangan.style.color = "#b91c1c";
  } finally {
    btnSimpanKeuangan.disabled = false;
  }
});

/* ------------------------------------------------------------
   BAGIAN 7 — LOGIKA KIRIM DATA KE SPREADSHEET (E-MONEY)
------------------------------------------------------------ */
const btnSimpanEmoney = formEmoney.querySelector('.btn-primary');
const statusEmoney = document.createElement('div');
statusEmoney.style.textAlign = "center";
statusEmoney.style.marginTop = "10px";
statusEmoney.style.fontWeight = "600";
statusEmoney.style.color = "#475569";
formEmoney.appendChild(statusEmoney);

btnSimpanEmoney.addEventListener("click", async () => {
  const payload = {
    Source: "Emoney",
    Tanggal: document.getElementById("tglEmoney").value,
    Keperluan: document.getElementById("keperluanEmoney").value.trim(),
    Jenis: document.getElementById("jenisEmoney").value,
    Tipe: document.getElementById("tipeEmoney").value,
    Kategori: document.getElementById("kategoriEmoney").value,
    Jumlah: document.getElementById("jumlahEmoney").value
  };

  if (!payload.Tanggal || !payload.Keperluan || !payload.Jumlah || payload.Tipe === "Pilih...") {
    alert("⚠️ Mohon lengkapi semua data sebelum mengirim!");
    return;
  }

  statusEmoney.textContent = "⏳ Mengirim data...";
  btnSimpanEmoney.disabled = true;

  try {
    const res = await fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify(payload)
    });

    if (res.ok) {
      statusEmoney.textContent = "✅ Data berhasil dikirim ke Emoney_2025!";
      statusEmoney.style.color = "#16a34a";
      formEmoney.querySelectorAll("input, select").forEach(el => el.value = "");
    } else throw new Error();
  } catch {
    statusEmoney.textContent = "❌ Gagal mengirim data ke Emoney_2025.";
    statusEmoney.style.color = "#b91c1c";
  } finally {
    btnSimpanEmoney.disabled = false;
  }
});
</script>
  <!-- ====================== END SCRIPT SECTION ====================== -->

</body>
</html>
